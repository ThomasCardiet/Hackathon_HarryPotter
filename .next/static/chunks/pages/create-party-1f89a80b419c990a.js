(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[210],{7706:function(t,e,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/create-party",function(){return s(4624)}])},3695:function(t,e,s){"use strict";s.d(e,{V:function(){return i}});var a=s(4924),r=s(6154);let n="auth";class i{static getPath(){return this.path}static getRoutes(){return this.routes}static getHeaders(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={Accept:"application/json","Content-Type":"application/json"};return Object.values(t).forEach(t=>{let[s,a]=t;e[s]=a}),e}static async fetchApi(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET",a={method:s,headers:this.getHeaders()};return Object.keys(e).length>0&&(a.body=JSON.stringify(e)),await fetch("".concat("https://hp-api-iim.azurewebsites.net").concat(this.getPath()).concat(t),a).then(t=>t.json()).then(t=>t).catch(t=>({status:400,message:t.message}))}static async getAllUsers(){return await this.fetchApi(this.getRoutes().GET_USERS)}static async loginUser(t){return this.isLoggedUser()?{statusCode:500,message:"Vous \xeates d\xe9j\xe0 connect\xe9"}:await this.fetchApi(this.getRoutes().AUTH_LOGIN,t,"POST")}static LogoutUser(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.isLoggedUser()?(this.unStoreUser(),t&&t(null),{statusCode:200,message:"Vous avez \xe9t\xe9 d\xe9connect\xe9"}):{statusCode:400,message:"Vous n'\xeates pas connect\xe9"}}static storeUser(t){localStorage.setItem(n,JSON.stringify(t))}static unStoreUser(){localStorage.removeItem(n)}static isLoggedUser(){return!!localStorage.getItem(n)}static getLoggedUser(){if(!this.isLoggedUser())return null;let t=JSON.parse(localStorage.getItem(n));return t.user?t.user:null}}(0,a.Z)(i,"path","/"),(0,a.Z)(i,"routes",{GET_USERS:"users",AUTH_LOGIN:"auth/log-in",AUTH_REGISTER:"auth/register"}),(0,a.Z)(i,"postNewGame",async t=>{if(!i.isLoggedUser())return null;let e=JSON.parse(localStorage.getItem(n)),s=await r.Z.post("https://hp-api-iim.azurewebsites.net/matches/start",t,{headers:{Authorization:"Bearer "+e.token,"Content-Type":"application/json"}});console.log(s)})},9560:function(t,e,s){"use strict";s.r(e),s.d(e,{Waiting:function(){return n}});var a=s(5893);s(7294);var r=s(238);let n=()=>(0,a.jsx)("div",{className:"waiting-block",children:(0,a.jsx)(r.iT,{height:100,width:100,color:"#F9C749",wrapperStyle:{},wrapperClass:"",visible:!0,ariaLabel:"oval-loading",secondaryColor:"##FFEBB8",strokeWidth:2,strokeWidthSecondary:2})})},4624:function(t,e,s){"use strict";s.r(e);var a=s(5893),r=s(9560),n=s(1163),i=s(7294),o=s(3695),c=s(1637);let u=()=>{let[t,e]=(0,i.useState)(null),[s,u]=(0,i.useState)(null),l=(0,n.useRouter)();(0,i.useEffect)(()=>{e(o.V.getLoggedUser())},[]),(0,i.useEffect)(()=>{g()},[]);let g=async()=>{await fetch("/api/socket");let t=(0,c.ZP)();u(t),t.on("connect",()=>{}),t.on("redirectRoom",t=>{let{user:e,room:s}=t;l.push("/create-party/".concat(s.id))})},h=()=>{s&&s.emit("createParty",t)};return(0,i.useEffect)(()=>{h()},[s]),(0,a.jsx)(r.Waiting,{})};e.default=u}},function(t){t.O(0,[245,637,774,888,179],function(){return t(t.s=7706)}),_N_E=t.O()}]);