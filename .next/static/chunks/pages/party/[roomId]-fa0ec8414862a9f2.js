(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[339,149,530,468,298,47],{5336:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/party/[roomId]",function(){return n(4315)}])},3695:function(e,t,n){"use strict";n.d(t,{V:function(){return r}});var s=n(4924),i=n(6154);let a="auth";class r{static getPath(){return this.path}static getRoutes(){return this.routes}static getHeaders(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={Accept:"application/json","Content-Type":"application/json"};return Object.values(e).forEach(e=>{let[n,s]=e;t[n]=s}),t}static async fetchApi(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET",s={method:n,headers:this.getHeaders()};return Object.keys(t).length>0&&(s.body=JSON.stringify(t)),await fetch("".concat("https://hp-api-iim.azurewebsites.net").concat(this.getPath()).concat(e),s).then(e=>e.json()).then(e=>e).catch(e=>({status:400,message:e.message}))}static async getAllUsers(){return await this.fetchApi(this.getRoutes().GET_USERS)}static async loginUser(e){return this.isLoggedUser()?{statusCode:500,message:"Vous \xeates d\xe9j\xe0 connect\xe9"}:await this.fetchApi(this.getRoutes().AUTH_LOGIN,e,"POST")}static LogoutUser(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.isLoggedUser()?(this.unStoreUser(),e&&e(null),{statusCode:200,message:"Vous avez \xe9t\xe9 d\xe9connect\xe9"}):{statusCode:400,message:"Vous n'\xeates pas connect\xe9"}}static storeUser(e){localStorage.setItem(a,JSON.stringify(e))}static unStoreUser(){localStorage.removeItem(a)}static isLoggedUser(){return!!localStorage.getItem(a)}static getLoggedUser(){if(!this.isLoggedUser())return null;let e=JSON.parse(localStorage.getItem(a));return e.user?e.user:null}}(0,s.Z)(r,"path","/"),(0,s.Z)(r,"routes",{GET_USERS:"users",AUTH_LOGIN:"auth/log-in",AUTH_REGISTER:"auth/register"}),(0,s.Z)(r,"postNewGame",async e=>{if(!r.isLoggedUser())return null;let t=JSON.parse(localStorage.getItem(a)),n=await i.Z.post("https://hp-api-iim.azurewebsites.net/matches/start",e,{headers:{Authorization:"Bearer "+t.token,"Content-Type":"application/json"}});console.log(n)})},3582:function(e,t,n){"use strict";n.r(t),n.d(t,{CountDown:function(){return g},DEFAULT_INIT_TIME:function(){return l},MINUTE:function(){return o},SECOND:function(){return c}});var s=n(5893),i=n(4184),a=n.n(i),r=n(7294);let o=60,c=1e3,l=5*o,u=e=>{let t=Math.trunc(e/o);return"".concat(t.toString().padStart(2,"0"),":").concat((e-t*o).toString().padStart(2,"0"))},g=e=>{let{time:t,setTime:n,setParentState:i=null,start:o=!0}=e,[g,d]=(0,r.useState)(o),[m,h]=(0,r.useState)(l),[p,x]=(0,r.useState)(null);return(0,r.useEffect)(()=>{if(g&&null===p){h(t);let e=setInterval(()=>{n(e=>e-1)},c);x(e)}else clearInterval(p);return()=>clearInterval(p)},[g]),(0,r.useEffect)(()=>{t<=0&&(n(0),d(!1),i&&i(!0))},[t]),(0,s.jsx)("div",{className:a()("count-down",{warning:t<m/2&&t>m/4,dangerous:t<m/4}),children:(0,s.jsx)("p",{children:u(t)})})}},5149:function(e,t,n){"use strict";n.r(t),n.d(t,{DraggableIngredient:function(){return m}});var s=n(5893),i=n(1193),a=n.n(i);n(6685);var r=n(7294),o=n(4184),c=n.n(o),l=n(4298);let u={x:0,y:0},g=(e,t)=>{if(!t)return!1;let n={x:e.getBoundingClientRect().left+parseInt(getComputedStyle(e).width)/2,y:e.getBoundingClientRect().top+parseInt(getComputedStyle(e).height)/2};return n.x>=t.x.min&&n.x<=t.x.max&&n.y>=t.y.min&&n.y<=t.y.max};var d=n(7521);let m=e=>{let{ingredient:t,dropBoxOffsets:n,dropIngredient:i}=e,o=(0,r.useRef)(null),m=(0,r.useRef)(null),[h,p]=(0,r.useState)(null),[x,I]=(0,r.useState)(!1),[N,f]=(0,r.useState)(!1),v=(0,r.useCallback)(()=>{var e;p(u),null===(e=m.current)||void 0===e||e.setState(u)},[p,m]),E=()=>{I(!0)},S=(e,t)=>{f(g(t.node,n))},R=(e,n)=>{I(!1),N&&i(t),f(!1),v()};(0,r.useEffect)(()=>{x?(w(0),A(0),j(1)):(w(40),A(40),j(1.2))},[x]);let[O,j]=(0,r.useState)(1.2),[C,w]=(0,r.useState)(40),[_,A]=(0,r.useState)(40);return(0,s.jsx)(d.Z,{reset:!0,tiltReverse:!0,glareEnable:!0,glareBorderRadius:"100px",glareReverse:!0,glareColor:"#FFF9F0",scale:O,transitionEasing:"cubic-bezier(.03,.98,.52,.99)",tiltMaxAngleX:C,tiltMaxAngleY:_,children:(0,s.jsx)(a(),{onStart:E,onDrag:S,onStop:R,nodeRef:o,ref:m,position:h,children:(0,s.jsxs)("div",{ref:o,className:c()("draggable-ingredient",{drag:x,droppable:N,"not-droppable":!N&&x}),children:[t.getImgComponent(),(0,s.jsx)("div",{className:"draggable-ingredient__icon",children:l.ICONS.PLUS})]})})})}},2530:function(e,t,n){"use strict";n.r(t),n.d(t,{DropBlock:function(){return r}});var s=n(5893),i=n(7294),a=n(5468);let r=e=>{let{cauldron:t,setDropBoxOffsets:n}=e,r=(0,i.useRef)(null),[o]=(0,a.usePosition)(r);return(0,i.useEffect)(()=>{n(o)},[o]),(0,s.jsx)("div",{className:"drop-block",ref:r,children:t.getImgComponent()})}},5468:function(e,t,n){"use strict";n.r(t),n.d(t,{usePosition:function(){return i}});var s=n(7294);let i=e=>{let[t,n]=(0,s.useState)(null);return(0,s.useEffect)(()=>{let t=e.current;if(t){let e={top:t.getBoundingClientRect().top,left:t.getBoundingClientRect().left},{width:s,height:i}=getComputedStyle(t);n({x:{min:e.left,max:e.left+parseInt(s)},y:{min:e.top,max:e.top+parseInt(i)}})}},[e]),[t,n]}},4298:function(e,t,n){"use strict";n.r(t),n.d(t,{ICONS:function(){return a}});var s=n(5893);n(7294);var i=(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"w-6 h-6",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})});let a={PLUS:i}},6047:function(e,t,n){"use strict";n.r(t),n.d(t,{Party:function(){return _}});var s=n(5893),i=n(7294),a=n(5149),r=n(2530),o=n(6685),c=n(4924);class l{getName(){return this.name}getIsMaterial(){return this.isMaterial}setName(e){this.name=e}setIsMaterial(e){this.isMaterial=e}constructor(e,t=!0){(0,c.Z)(this,"name",void 0),(0,c.Z)(this,"isMaterial",void 0),this.name=e,this.isMaterial=t}}let u={FOLDABLE:new l("pliable",!1),SILVER:new l("argent"),COPPER:new l("cuivre"),BRASS:new l("laiton")};class g{getName(){return this.name}getType(){return this.type}getImgPath(){return"".concat(this.img.basePath,"/").concat(this.img.name)}getImgComponent(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(0,s.jsx)("img",{src:this.getImgPath(),alt:"Picture of Cauldron",useMap:"#".concat(e)})}setName(e){this.name=e}setType(e){this.type=e}constructor(e,t=d.DEFAULT){(0,c.Z)(this,"type",void 0),(0,c.Z)(this,"name",void 0),(0,c.Z)(this,"img",{basePath:"/images/cauldrons",name:null}),this.type=e,this.name="Chaudron ".concat(e.getIsMaterial()?"en ":"").concat(e.getName()),this.img.name=t}}let d={DEFAULT:"cauldron_default.png"},m={FOLDABLE:new g(u.FOLDABLE),SILVER:new g(u.SILVER),COPPER:new g(u.COPPER),BRASS:new g(u.BRASS)};var h=n(1678);class p{getName(){return this.name}getIngredients(){return this.ingredients}getCauldron(){return this.cauldron}setName(e){this.name=e}setIngredients(e){this.ingredients=e}setCauldron(e){this.cauldron=e}constructor(e,t,n){(0,c.Z)(this,"name",void 0),(0,c.Z)(this,"ingredients",void 0),(0,c.Z)(this,"cauldron",void 0),this.name=e,this.ingredients=t,this.cauldron=n}}let x={ANTIDOT:new p("Antidote",[o.Wv.BEZOAR,o.Wv.ACONITE,o.Wv.ORPHIDIAN_SKIN],m.FOLDABLE),WIGGENWELD:new p("Wiggenweld",[o.Wv.SILVER_UNICORN_HORN,o.Wv.ACONITE],m.FOLDABLE),WIGGENWELD_EXTRA:new p("Wiggenweld extra",[o.Wv.OCTOPUS_POWDER,o.Wv.SILVER_UNICORN_HORN,o.Wv.ACONITE],m.SILVER),HERBICIDE:new p("Herbicide",[o.Wv.DRIED_NETTLES,o.Wv.PORCUPINE_QUILLS,o.Wv.SNAKE_HOOKS],m.COPPER),PIMENTINE:new p("Pimentine",[o.Wv.BICORN_HORN,o.Wv.MANDRAKE_ROOT],m.COPPER),PIMENTINE_EXTRA:new p("Pimentine extra",[o.Wv.OCTOPUS_POWDER,o.Wv.BICORN_HORN,o.Wv.MANDRAKE_ROOT],m.BRASS),VITAMIX:new p("Vitamix",[o.Wv.MUGWORT,o.Wv.ASPHODEL_ROOT,o.Wv.DICTAME],m.COPPER)},I=()=>Object.values(x),N=()=>(0,h.S)(I()).slice(0,3);var f=n(3695),v=n(4339),E=n(1163),S=n(1664),R=n.n(S),O=n(118),j=n(3582),C=n(5678);let w={INDICE:20,WRONG_INGREDIENT:5},_=e=>{let{user:t,stopGame:n,winner:c}=e,l=(0,E.useRouter)(),[u,g]=(0,i.useState)(t?t.house.name:"Ravenclaw"),[d,m]=(0,i.useState)((0,s.jsx)("img",{src:"/images/"+u+".png"})),[h,p]=(0,i.useState)([]),[x,I]=(0,i.useState)([]),[S,_]=(0,i.useState)(null),[A,T]=(0,i.useState)(!1),[P,b]=(0,i.useState)(j.DEFAULT_INIT_TIME),[y,L]=(0,i.useState)([]),[D,k]=(0,i.useState)(0),[U,W]=(0,i.useState)(0);(0,i.useEffect)(()=>{f.V.isLoggedUser()||l.push(v.F.getRoutes().LOGIN.slug),x.length||I((0,o.kt)()),y.length||L(N())},[]);let B=e=>{if("flip"===F||"flip"===Z||"flip"===z)return C.Am.error("Impossible, vous lisez un indice !",{icon:"❌",theme:"light",position:"bottom-center"});let t=y[D].getIngredients()[U];e===t?(J(!0),Y(),C.Am.success("Ingr\xe9dient ajout\xe9",{icon:"\uD83E\uDDEA",theme:"light",position:"bottom-center"}),I(x.filter(t=>e!==t)),U<y[D].getIngredients().length-1?W(e=>e+1):D<y.length-1?(k(e=>e+1),W(0),I((0,o.kt)()),C.Am.success("Bien jou\xe9, potion suivante !",{icon:"\uD83E\uDDEA",theme:"light",position:"bottom-center"})):T(!0)):(b(e=>e-w.WRONG_INGREDIENT),C.Am.error("Mauvais ingr\xe9dient (- 5 sec)",{icon:"❌",theme:"light",position:"bottom-center"}))},[M,H]=(0,i.useState)([{indiceTaken:!1},{indiceTaken:!1},{indiceTaken:!1}]),[F,G]=(0,i.useState)(""),[Z,V]=(0,i.useState)(""),[z,K]=(0,i.useState)(""),[X,J]=(0,i.useState)(!0),Y=()=>{V(""),G(""),K("")},q=e=>{if(P<=w.INDICE+10)return C.Am.error("Tu nas plus le temps !",{icon:"❌",theme:"light",position:"bottom-center"});let t=M.find((t,n)=>n===e);if(!1===t.indiceTaken&&X){b(e=>e-w.INDICE);let n=[...M];t.indiceTaken=!0,H(n),0===e?G("flip"):1===e?V("flip"):2===e&&K("flip"),J(!1),setTimeout(()=>{Y()},3e3)}};return(0,i.useEffect)(()=>{A&&n()},[A]),(0,i.useEffect)(()=>{c&&(T(!0),C.Am.success("".concat(c.name," est le grand gagnant !"),{icon:"\uD83D\uDC4A",theme:"light",position:"bottom-right"}))},[c]),(0,s.jsx)(s.Fragment,{children:A?(0,s.jsx)("section",{className:"success "+u,children:(0,s.jsxs)("aside",{className:"success-container",children:[(0,s.jsxs)("div",{className:"success-container-title",children:[(0,s.jsx)("h1",{className:"text-50 text-Harry text-yellow",children:(0,s.jsx)(O.kX,{from:{opacity:"0",scale:"0.4"},to:{opacity:"100%",scale:"1"},ease:"expo.out()",duration:6,stagger:.1,children:(0,s.jsx)(O.H5,{wrapper:(0,s.jsx)("span",{style:{display:"inline-block"}}),children:"Victoire de la maison"})})}),(0,s.jsx)("h1",{className:"text-100 text-Harry text-yellow",children:(0,s.jsx)(O.kX,{from:{opacity:"0",scale:"0.4"},to:{opacity:"100%",scale:"1"},ease:"expo.out()",duration:6,stagger:.1,children:(0,s.jsx)(O.H5,{wrapper:(0,s.jsx)("span",{style:{display:"inline-block"}}),children:u})})})]}),(0,s.jsx)("div",{className:"success-container-logo",children:d}),c&&(0,s.jsxs)("p",{className:"success-container-logo-name text-30 text-ProzaLibre-SemiBold text-yellow",children:["Le joueur ",c.name," a gagn\xe9 !"]}),(0,s.jsx)("ul",{className:"success-container-content",children:h.map((e,t)=>(0,s.jsxs)("li",{className:"text-30 text-white text-ProzaLibre-Regular",children:[(0,s.jsx)("img",{src:"/images/"+e.house+".png"}),e.name," - ",e.potionDone," / 3"]},t))}),(0,s.jsx)("div",{className:"success-container-button",children:(0,s.jsx)(R(),{href:"/choice",className:"btn-reset btn-yellow",children:"Rejouer"})})]})}):(0,s.jsxs)("div",{className:"party",children:[(0,s.jsx)(j.CountDown,{time:P,setTime:b,setParentState:T}),y&&y[D]&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"party__potion-name",children:[(0,s.jsxs)("h1",{children:["Potion (",D+1,"/",y.length,"):"," ",y[D].getName()]}),y[D].getIngredients()[U]&&(0,s.jsxs)("p",{children:["Ingr\xe9dient requis:"," ",(0,s.jsx)("span",{children:y[D].getIngredients()[U].name})]})]}),(0,s.jsx)(r.DropBlock,{cauldron:y[D].getCauldron(),setDropBoxOffsets:_})]}),(0,s.jsx)("div",{className:"indices",children:(0,s.jsx)("div",{className:"indices-container",children:M.map((e,t)=>0===t?(0,s.jsxs)("div",{onClick:e=>q(t),className:"indices-container-item first "+F+(X?"":" inactive")+(!0===e.indiceTaken?" inactive":""),children:[(0,s.jsx)("div",{className:"indices-container-item-image"}),(0,s.jsx)("div",{className:"indices-container-item-background ",children:(0,s.jsx)("img",{src:"/images/carte.png"})}),(0,s.jsx)("div",{className:"content",children:y&&y[D]&&y[D].getIngredients()[U]&&y[D].getIngredients()[U].getImgComponent()})]},t):1===t?(0,s.jsxs)("div",{onClick:e=>q(t),className:"indices-container-item second "+Z+(X?"":" inactive")+(!0===e.indiceTaken?" inactive":""),children:[(0,s.jsx)("div",{className:"indices-container-item-image"}),(0,s.jsx)("div",{className:"indices-container-item-background",children:(0,s.jsx)("img",{src:"/images/carte.png"})}),(0,s.jsx)("div",{className:"content",children:y&&y[D]&&y[D].getIngredients()[U]&&y[D].getIngredients()[U].getImgComponent()})]},t):2===t?(0,s.jsxs)("div",{onClick:e=>q(t),className:"indices-container-item third "+z+(X?"":" inactive")+(!0===e.indiceTaken?" inactive":""),children:[(0,s.jsx)("div",{className:"indices-container-item-image"}),(0,s.jsx)("div",{className:"indices-container-item-background",children:(0,s.jsx)("img",{src:"/images/carte.png"})}),(0,s.jsx)("div",{className:"content",children:y&&y[D]&&y[D].getIngredients()[U]&&y[D].getIngredients()[U].getImgComponent()})]},t):void 0)})}),(0,s.jsx)("ul",{className:"ingredients-block",children:x.map((e,t)=>(0,s.jsx)(a.DraggableIngredient,{dropBoxOffsets:S,ingredient:e,dropIngredient:B},t))})]})})}},9560:function(e,t,n){"use strict";n.r(t),n.d(t,{Waiting:function(){return a}});var s=n(5893);n(7294);var i=n(238);let a=()=>(0,s.jsx)("div",{className:"waiting-block",children:(0,s.jsx)(i.iT,{height:100,width:100,color:"#F9C749",wrapperStyle:{},wrapperClass:"",visible:!0,ariaLabel:"oval-loading",secondaryColor:"##FFEBB8",strokeWidth:2,strokeWidthSecondary:2})})},6685:function(e,t,n){"use strict";n.d(t,{AE:function(){return c},Wv:function(){return o},kt:function(){return l}});var s=n(4924),i=n(5893),a=n(1678);class r{getName(){return this.name}getBonus(){return this.bonus}getImgPath(){return"".concat(this.img.basePath,"/").concat(this.img.name)}getImgComponent(){return(0,i.jsx)("img",{src:this.getImgPath(),alt:"Picture of ingredient"})}setName(e){this.name=e}setBonus(e){this.bonus=e}constructor(e,t=0,n){(0,s.Z)(this,"name",void 0),(0,s.Z)(this,"bonus",void 0),(0,s.Z)(this,"img",{basePath:"/images/ingredients",name:null}),this.name=e,this.bonus=t,this.img.name=n}}let o={ASPHODEL_ROOT:new r("Racine d'asphod\xe8le",0,"asphodel_root.png"),NAPEL:new r("Napel",0,"nepal.png"),DRIED_NETTLES:new r("Orties s\xe9ch\xe9es",0,"dried_nettles.png"),DICTAME:new r("Dictame",0,"dictame.png"),MUGWORT:new r("Armoise",0,"mugwort.png"),MANDRAKE_ROOT:new r("Racine de mandragore",0,"mandrake_root.png"),ORPHIDIAN_SKIN:new r("Peau d'ophidien",0,"orphidian_skin.png"),PORCUPINE_QUILLS:new r("\xc9pines de porc-\xe9pic",0,"porcupine_quills.png"),OCTOPUS_POWDER:new r("Poudre de pieuvre",0,"octopus_powder.png"),SCARAB_EYES:new r("Yeux de scarab\xe9e",0,"scarab_eyes.png"),BICORN_HORN:new r("Corne de bicorne",0,"bicorn_horn.png"),SNAKE_HOOKS:new r("Crochets de serpent",0,"snake_hooks.png"),BEZOAR:new r("B\xe9zoard",0,"bezoar.png"),SILVER_UNICORN_HORN:new r("Corne de licorne en argent",0,"silver_unicorn_horn.png"),ACONITE:new r("Aconit",0,"aconit.png")},c=()=>Object.values(o),l=()=>(0,a.S)(c())},1678:function(e,t,n){"use strict";n.d(t,{S:function(){return s}});let s=e=>{let t=e.length,n;for(;0!=t;)n=Math.floor(Math.random()*t),t--,[e[t],e[n]]=[e[n],e[t]];return e}},4315:function(e,t,n){"use strict";n.r(t);var s=n(5893),i=n(6047),a=n(1163),r=n(9560),o=n(7294),c=n(3695),l=n(1637),u=n(4339);let g=()=>{let e=(0,a.useRouter)(),{roomId:t}=e.query,[n,g]=(0,o.useState)(null),[d,m]=(0,o.useState)(null),[h,p]=(0,o.useState)(null),[x,I]=(0,o.useState)(null);(0,o.useEffect)(()=>{c.V.isLoggedUser()||e.push(u.F.getRoutes().LOGIN.slug),g(c.V.getLoggedUser())},[]),(0,o.useEffect)(()=>{N()},[]);let N=async()=>{await fetch("/api/socket");let n=(0,l.ZP)();m(n),n.on("connect",()=>{}),n.on("setRoom",t=>{let{room:n}=t;if(n.started&&!n.users.find(e=>e.id===c.V.getLoggedUser().id))return e.push(u.F.getRoutes().CHOICE.slug);p(n.winner),I(n)}),n.on("sendWinner",e=>{let{rId:n,winner:s}=e;parseInt(t)===parseInt(n)&&s&&p(s)})},f=()=>{d&&t&&d.emit("getRoomById",t)},v=()=>{d&&t&&n&&d.emit("stopGame",{roomId:t,winner:n})};return((0,o.useEffect)(()=>{f()},[d,t]),n&&x)?(0,s.jsx)(i.Party,{user:n,stopGame:v,winner:h}):(0,s.jsx)(r.Waiting,{})};t.default=g},4339:function(e,t,n){"use strict";n.d(t,{F:function(){return i}});var s=n(4924);class i{static getRoutes(){return this.routes}static getStaticPaths(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"slug";return Object.values(this.getRoutes()).map(t=>({params:{[e]:t.slug.substring(1).split("/")}}))}static getPathByArray(e){return e&&e.length>0?"/".concat(e.join("/")):"/"}static getRouteBySlug(e){return Object.values(this.getRoutes()).find(t=>t.slug===e)}}(0,s.Z)(i,"routes",{CHOICE:{name:"Choice",slug:"/choice"},LOGIN:{name:"Login",slug:"/login"},HOME:{name:"Home",slug:"/"},PARTY:{name:"Party",slug:"/party"},JOIN_PARTY:{name:"JoinParty",slug:"/join-party"},COMPTEUR:{name:"Compteur",slug:"/compteur"}})}},function(e){e.O(0,[802,118,664,245,637,897,774,888,179],function(){return e(e.s=5336)}),_N_E=e.O()}]);